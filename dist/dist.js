!function(e){function t(t){for(var a,r,s=t[0],u=t[1],l=t[2],f=0,m=[];f<s.length;f++)r=s[f],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&m.push(i[r][0]),i[r]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a]);for(c&&c(t);m.length;)m.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,s=1;s<n.length;s++){var u=n[s];0!==i[u]&&(a=!1)}a&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},i={0:0},o=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var s=window.webpackJsonp=window.webpackJsonp||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var c=u;o.push([77,1]),n()}({185:function(e,t,n){"use strict";n.r(t);var a=n(2),i=n.n(a),o=n(29),r=n.n(o),s=n(17),u=n(76),l=n(74),c=n.n(l),f=n(3),m=n(75),p=f.n.fromJSON(m),h={content:{text:""},updated_at:new Date};function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function d(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),e}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.updateObservers=[],this.note=h,this.initiateBridge()}return d(e,null,[{key:"get",value:function(){return null==this.instance&&(this.instance=new e),this.instance}}]),d(e,[{key:"addUpdateObserver",value:function(e){var t={callback:e};return this.updateObservers.push(t),t}},{key:"notifyObserversOfUpdate",value:function(){var e=!0,t=!1,n=void 0;try{for(var a,i=this.updateObservers[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){a.value.callback()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"getNote",value:function(){return this.note}},{key:"saveNote",value:function(e){var t=this.note;t.content.text=e,this.componentManager.saveItemWithPresave(t,(function(){t.content.text=e}))}},{key:"initiateBridge",value:function(){var e=this;this.componentManager=new c.a([{name:"stream-context-item"}],(function(){})),this.componentManager.streamContextItem((function(t){e.note=t,e.notifyObserversOfUpdate()})),this.componentManager.streamItems(["SN|Component","SN|Theme","SF|Extension"],(function(t){e.items=t.filter((function(e){return!e.isMetadataUpdate}))}))}}]),e}();function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(){var e;I&&(e=console).log.apply(e,arguments)},I=!0,j=function(e){function t(e){var n,a,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,i=x(t).call(this,e),n=!i||"object"!==g(i)&&"function"!=typeof i?S(a):i,w(S(n),"handleUpdateFromSN",(function(){var e=y.get().getNote();n.lastSNNote==h&&n.setState({slateValue:n.snToSlate(e)}),n.lastSNNote=e})),w(S(n),"handleEditFromSlate",(function(e){var t=n.slateToSN(e.value);O(e.operations.map((function(e){return e.type})).toArray()),t&&(y.get().saveNote(t),n.setState({slateValue:e.value}))})),w(S(n),"snToSlate",(function(e){return e?s.a.deserialize(e.content.text).set("selection",n.state.slateValue.selection):p})),w(S(n),"slateToSN",(function(e){return s.a.serialize(e)})),console.clear(),n.state={slateValue:p},n.lastSNNote=h,y.get().addUpdateObserver(n.handleUpdateFromSN),n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(u.a,{value:this.state.slateValue,onChange:this.handleEditFromSlate}))}}])&&b(n.prototype,a),o&&b(n,o),t}(i.a.Component);function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function P(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),P(this,_(t).call(this,e))}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(j,null))}}])&&T(n.prototype,a),o&&T(n,o),t}(i.a.Component);r.a.render(i.a.createElement(C,null),document.body.appendChild(document.createElement("div")))},74:function(e,t,n){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var i=function(){var e;o&&(e=console).log.apply(e,arguments)},o=!1,r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sentMessages=[],this.messageQueue=[],this.loggingEnabled=!1,this.acceptsThemes=!0,this.activeThemes=[],this.initialPermissions=t,this.onReadyCallback=n,this.coallesedSaving=!0,this.coallesedSavingDelay=250,this.registerMessageHandler()}var t,n,o;return t=e,(n=[{key:"registerMessageHandler",value:function(){var e=this,t=function(t){i("Components API Message received:",t.data),e.origin||(e.origin=t.origin);var n=t.data,a="string"==typeof n?JSON.parse(n):n;e.handleMessage(a)};document.addEventListener("message",(function(e){t(e)}),!1),window.addEventListener("message",(function(e){t(e)}),!1)}},{key:"handleMessage",value:function(e){if(i("Message: ",e),"component-registered"===e.action)this.sessionKey=e.sessionKey,this.componentData=e.componentData,this.onReady(e.data),i("Component successfully registered with payload:",e);else if("themes"===e.action)this.acceptsThemes&&this.activateThemes(e.data.themes);else if(e.original){var t=this.sentMessages.filter((function(t){return t.messageId===e.original.messageId}))[0];i("Comparing Message ids:",this.sentMessages.map((function(e){return e.messageId})),e.original.messageId),t||alert("This extension is attempting to communicate with Standard Notes, but an error is preventing it from doing so. Please restart this extension and try again."),t.callback&&t.callback(e.data)}}},{key:"onReady",value:function(e){this.environment=e.environment,this.platform=e.platform,this.uuid=e.uuid,this.isMobile="mobile"==this.environment,this.initialPermissions&&this.initialPermissions.length>0&&this.requestPermissions(this.initialPermissions);var t=!0,n=!1,a=void 0;try{for(var o,r=this.messageQueue[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var s=o.value;this.postMessage(s.action,s.data,s.callback)}}catch(e){n=!0,a=e}finally{try{t||null==r.return||r.return()}finally{if(n)throw a}}this.messageQueue=[],i("onReadyData",e),this.activateThemes(e.activeThemeUrls||[]),this.onReadyCallback&&this.onReadyCallback()}},{key:"getSelfComponentUUID",value:function(){return this.uuid}},{key:"isRunningInDesktopApplication",value:function(){return"desktop"===this.environment}},{key:"setComponentDataValueForKey",value:function(e,t){this.componentData[e]=t,this.postMessage("set-component-data",{componentData:this.componentData},(function(){}))}},{key:"clearComponentData",value:function(){this.componentData={},this.postMessage("set-component-data",{componentData:this.componentData},(function(){}))}},{key:"componentDataValueForKey",value:function(e){return this.componentData[e]}},{key:"postMessage",value:function(e,t,n){if(this.sessionKey){var a={action:e,data:t,messageId:this.generateUUID(),sessionKey:this.sessionKey,api:"component"},o=JSON.parse(JSON.stringify(a));o.callback=n,this.sentMessages.push(o),this.isMobile&&(a=JSON.stringify(a)),i("Posting message:",a),window.parent.postMessage(a,this.origin)}else this.messageQueue.push({action:e,data:t,callback:n})}},{key:"setSize",value:function(e,t,n){this.postMessage("set-size",{type:e,width:t,height:n},(function(){}))}},{key:"requestPermissions",value:function(e,t){this.postMessage("request-permissions",{permissions:e},function(){t&&t()}.bind(this))}},{key:"streamItems",value:function(e,t){Array.isArray(e)||(e=[e]),this.postMessage("stream-items",{content_types:e},function(e){t(e.items)}.bind(this))}},{key:"streamContextItem",value:function(e){var t=this;this.postMessage("stream-context-item",null,(function(n){var a=n.item;(!t.lastStreamedItem||t.lastStreamedItem.uuid!==a.uuid)&&t.pendingSaveTimeout&&(clearTimeout(t.pendingSaveTimeout),t._performSavingOfItems(t.pendingSaveParams),t.pendingSaveTimeout=null,t.pendingSaveParams=null),t.lastStreamedItem=a,e(t.lastStreamedItem)}))}},{key:"selectItem",value:function(e){this.postMessage("select-item",{item:this.jsonObjectForItem(e)})}},{key:"createItem",value:function(e,t){this.postMessage("create-item",{item:this.jsonObjectForItem(e)},function(e){var n=e.item;!n&&e.items&&e.items.length>0&&(n=e.items[0]),this.associateItem(n),t&&t(n)}.bind(this))}},{key:"createItems",value:function(e,t){var n=this,a=e.map((function(e){return n.jsonObjectForItem(e)}));this.postMessage("create-items",{items:a},function(e){t&&t(e.items)}.bind(this))}},{key:"associateItem",value:function(e){this.postMessage("associate-item",{item:this.jsonObjectForItem(e)})}},{key:"deassociateItem",value:function(e){this.postMessage("deassociate-item",{item:this.jsonObjectForItem(e)})}},{key:"clearSelection",value:function(){this.postMessage("clear-selection",{content_type:"Tag"})}},{key:"deleteItem",value:function(e,t){this.deleteItems([e],t)}},{key:"deleteItems",value:function(e,t){var n={items:e.map(function(e){return this.jsonObjectForItem(e)}.bind(this))};this.postMessage("delete-items",n,(function(e){t&&t(e)}))}},{key:"sendCustomEvent",value:function(e,t,n){this.postMessage(e,t,function(e){n&&n(e)}.bind(this))}},{key:"saveItem",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.saveItems([e],t,n)}},{key:"saveItemWithPresave",value:function(e,t,n){this.saveItemsWithPresave([e],t,n)}},{key:"saveItemsWithPresave",value:function(e,t,n){this.saveItems(e,n,!1,t)}},{key:"_performSavingOfItems",value:function(e){var t=e.items,n=e.presave,a=e.callback;n&&n();var i=[],o=!0,r=!1,s=void 0;try{for(var u,l=t[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;i.push(this.jsonObjectForItem(c))}}catch(e){r=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(r)throw s}}this.postMessage("save-items",{items:i},(function(){a&&a()}))}},{key:"saveItems",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;if(this.pendingSaveItems||(this.pendingSaveItems=[]),1!=this.coallesedSaving||a)this._performSavingOfItems({items:e,presave:i,callback:t});else{this.pendingSaveTimeout&&clearTimeout(this.pendingSaveTimeout);var o=e.map((function(e){return e.uuid})),r=this.pendingSaveItems.filter((function(e){return!o.includes(e.uuid)}));this.pendingSaveItems=r.concat(e),this.pendingSaveParams={items:this.pendingSaveItems,presave:i,callback:t},this.pendingSaveTimeout=setTimeout((function(){n._performSavingOfItems(n.pendingSaveParams),n.pendingSaveItems=[],n.pendingSaveTimeout=null,n.pendingSaveParams=null}),this.coallesedSavingDelay)}}},{key:"jsonObjectForItem",value:function(e){var t=Object.assign({},e);return t.children=null,t.parent=null,t}},{key:"getItemAppDataValue",value:function(e,t){var n=e.content.appData&&e.content.appData["org.standardnotes.sn"];return n?n[t]:null}},{key:"activateThemes",value:function(e){if(i("Incoming themes",e),this.activeThemes.sort().toString()!=e.sort().toString()){var t=e||[],n=[],a=!0,o=!1,r=void 0;try{for(var s,u=this.activeThemes[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var l=s.value;e.includes(l)?t=t.filter((function(e){return e!=l})):n.push(l)}}catch(e){o=!0,r=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw r}}i("Deactivating themes:",n),i("Activating themes:",t);for(var c=0,f=n;c<f.length;c++){var m=f[c];this.deactivateTheme(m)}this.activeThemes=e;var p=!0,h=!1,v=void 0;try{for(var d,y=t[Symbol.iterator]();!(p=(d=y.next()).done);p=!0){var g=d.value;if(g){var b=document.createElement("link");b.id=btoa(g),b.href=g,b.type="text/css",b.rel="stylesheet",b.media="screen,print",b.className="custom-theme",document.getElementsByTagName("head")[0].appendChild(b)}}}catch(e){h=!0,v=e}finally{try{p||null==y.return||y.return()}finally{if(h)throw v}}}}},{key:"themeElementForUrl",value:function(e){var t=document.getElementsByClassName("custom-theme");return Array.from(t).slice().find((function(t){return t.id==btoa(e)}))}},{key:"deactivateTheme",value:function(e){var t=this.themeElementForUrl(e);t&&(t.disabled=!0,t.parentNode.removeChild(t))}},{key:"generateUUID",value:function(){var e=window.crypto||window.msCrypto;if(e){var t=new Uint32Array(4);e.getRandomValues(t);var n=-1;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var a=t[++n>>3]>>n%8*4&15;return("x"==e?a:3&a|8).toString(16)}))}var a=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(a+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==e?t:3&t|8).toString(16)}))}}])&&a(t.prototype,n),o&&a(t,o),e}();void 0!==e.exports&&(e.exports=r),window&&(window.ComponentManager=r)},75:function(e){e.exports=JSON.parse('{"object":"value","document":{"object":"document","nodes":[{"object":"block","type":"line","nodes":[{"object":"text","text":"The text is loading from Standard Notes..."}]}]}}')},77:function(e,t,n){e.exports=n(185)}});